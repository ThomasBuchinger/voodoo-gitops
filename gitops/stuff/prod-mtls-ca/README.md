# mTLS Details

This repository only contains the private key. The Certificate for the Root-CA is generated by cert-manager (if `spec.secretName` exists and contains a Key, it is reused). You can re-generate the Key using this command:

```shell
openssl req -x509 -newkey rsa:4096 -keyout secrets/stuff/prod-mtls-ca/tls.key -out secrets/stuff/prod-mtls-ca/tls.crt -sha512 -days 36500 -nodes -subj "/C=AT/O=BUC LAB/CN=mtls-buc-root-ca" -addext basicConstraints=critical,CA:TRUE -addext "keyUsage=critical,cRLSign,keyCertSign,digitalSignature,keyAgreement,keyEncipherment"
kubectl create secret generic mtls-buc-root-ca --from-file tls.crt=secrets/stuff/prod-mtls-ca/tls.crt --from-file tls.key=secrets/stuff/prod-mtls-ca/tls.key --from-file ca.crt=secrets/stuff/prod-mtls-ca/tls.crt --dry-run=client -o yaml --namespace prod --type kubernetes.io/tls --validate=false > secrets/stuff/prod-mtls-ca/mtls-buc-root-ca.yaml
make kubeseal

```

Device Certificates are signed directly by the Root-CA

(Maybe) To allow temporary access from unknown devices, a intermediary CA could be used to issue Certificates with only 24h lifetime